# Bruteforce and password cracking, offline

## Objectives:

1. Crack the hashes of user "admin" using John The Ripper/Hashcat and recover the password.
> Answer: foxtrot
2. Find the password for the protected Microsoft Office .docx file using John The Ripper/Hashcat.
> Answer: muenchen

## 1. Crack the hash of user "admin".

On Linux, the password hashes are stored in /etc/shadow. Get the usernames and passwords with

    cat /etc/shadow

![screenshot](../pentesting-basics/pictures/pw-cracking-lab-offline-1.jpg)

Save the admin credentials to a file named hash:

    tail -n 1 /etc/shadow > hash.hash

For the hash file to be in correct format for hashcat, remove all exept the password hash. 

From the beginning of the hashed password (\$6$), we see that the encryption method used is SHA-512. 

The password hash can be cracked with John the Ripper by simply:

    john hash.hash

![screenshot](../pentesting-basics/pictures/pw-cracking-lab-offline-3.jpg) 

Using hashcat:

    hashcat -a 0 hash.hash /usr/share/wordlists/rockyou.txt.gz

![screenshot](../pentesting-basics/pictures/pw-cracking-lab-offline-2.jpg) 

The password found is foxtrot. 

## 2. Find the password for the protected Microsoft Office .docx file.

Using John the Ripper, the password hash of the document can be extracted with the script /usr/share/john/office2john.py:

    /usr/share/john/office2john.py MS_Word_Document.docx > hash.txt

From the extracted hash we see that the document version is Office 2013. The hash looks like this:

![screenshot](../pentesting-basics/pictures/pw-cracking-lab-offline-4.jpg)

Now the hash can be cracked with John the Ripper:

    john --wordlist=./wordlists/1000000-password-seclists.txt hash.txt

![screenshot](../pentesting-basics/pictures/pw-cracking-lab-offline-5.jpg)

With hashcat, the hash can be cracked with:

    hashcat -a 0 -m 9600 hash.hash ./wordlists/1000000-password-seclists.txt

![screenshot](../pentesting-basics/pictures/pw-cracking-lab-offline-6.jpg)

The password for the document is muenchen.
